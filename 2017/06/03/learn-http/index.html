<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="夏明儒 JavaScript CSS HTML">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/favicon.ico">

    <title>
        
          http权威指南学习笔记 - 夏明儒的博客 | Mingru&#39;s Blog
        
    </title>

    <link rel="canonical" href="https://mingrutough.github.io/2017/06/03/learn-http/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/mingru-blog.css">    

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top is-visible is-fixed">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Mingru’s Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    <li>
                        <a href="/archives/">Archives</a>
                    </li>
                    <!--

                        
                    

                        
                        <li>
                            <a href="/archives/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    -->
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    
<!-- Image to hack wechat -->
<!-- <img src="https://mingrutough.github.io/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="{{ site.baseurl }}/{% if page.header-img %}{{ page.header-img }}{% else %}{{ site.header-img }}{% endif %}" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/home-bg.jpeg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                          <a class="tag" href="/tags/#O&#39;REILLY" title="O&#39;REILLY">O&#39;REILLY</a>
                        
                          <a class="tag" href="/tags/#http" title="http">http</a>
                        
                    </div>
                    <h1>http权威指南学习笔记</h1>
                    <h2 class="subheading">要成为一个合格的前端开发者，这个要啃</h2>
                    <span class="meta">
                        Posted by mingrutough on
                        2017-06-03
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
    <!-- Post Container -->
            <div class="
                col-lg-8
                col-md-8
                col-md-offset-1
                col-md-offset-1                                                
                post-container">

                <p><img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http_bg.jpg"></p>
<h2 id="第一章-HTTP概述"><a href="#第一章-HTTP概述" class="headerlink" title="第一章 HTTP概述"></a>第一章 HTTP概述</h2><blockquote>
<p>HTTP(Hypertext Transfer Protocol,超文本传输协议)是在万维网上进行通信时所使用的协议方案。HTTP有很多应用，但最著名的是用于Web浏览器和Web服务器之间的双工通信。</p>
</blockquote>
<h4 id="媒体类型"><a href="#媒体类型" class="headerlink" title="媒体类型"></a>媒体类型</h4><p>因特网上有数千种不同的的数据类型，http仔细地给每种要通过web传输的对象都打上了名为MIME类型的数据格式标签。web服务器会为所有http对象数据附加一个MIME类型。MIME类型是一种文本标记，表示一种主要的对象类型和一个特定的子类型，中间用一条斜杠来分隔。
    html格式的文档用text/html类型来标记；
    普通的ASCII文本文档用text/plain类型来标记……</p>
<h4 id="URI"><a href="#URI" class="headerlink" title="URI"></a>URI</h4><p>每一个Web服务器资源都有一个名字，这样客户端就可以告诉服务器它想要的资源是什么。服务器资源名被称为<b>统一资源标识符</b>(Uniform Resource Identifier, URI)。URI有两种形式。分别称为URL和URN。</p>
<ol>
<li><p>URL </p>
<p> 统一资源定位符描述了一台特定服务器上某资源的特定位置。大部分URL都遵循一种标准格式。这种格式包含三个部分：</p>
</li>
</ol>
<ul>
<li>方案(scheme)，说明了访问资源所使用的协议类型。这部分通常就是HTTP协议(<a href="http://)。" target="_blank" rel="external">http://)。</a></li>
<li>第二部分给出了服务器的因特网地址。(比如www.google.com)</li>
<li>其余部分指定了web服务器上的某个资源(比如/utils/heihei.png)</li>
</ul>
<ol>
<li><p>URN</p>
<p> URI的第二种形式就是统一资源名。URN是作为特定内容的唯一名称使用的，与目前的资源所在地无关。使用这些与位置无关的URN，就可以将资源四处搬移。通过URN，还可以用同一个名字通过多种网络协议来访问资源。不过，URN仍处于试验阶段，为了更有效工作，URN需要一个支撑架构来解析资源的位置，而此类架构的缺乏也延缓了其被采用的进度。</p>
</li>
</ol>
<h4 id="http事务"><a href="#http事务" class="headerlink" title="http事务"></a>http事务</h4><p>一个http事务由一条请求命令和一个响应结果组成。这种通信是通过名为http报文（http message）的格式化数据块进行的。如下图所示。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter1/http1-1.png"></p>
<h4 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP/IP"></a>TCP/IP</h4><p>http是个应用层协议。http无需操心网络通信的具体细节，它把联网的细节都交给了通用、可靠的因特网传输协议TCP/IP。TCP提供了：</p>
<ul>
<li>无差错的数据传输；</li>
<li>按序传输(数据总是会按照发送的顺序到达)；</li>
<li>未分段的数据流(可以在任意时刻以任意尺寸将数据发送出去)。</li>
</ul>
<p>因特网自身就是基于TCP/IP的,TCP/IP是全世界的计算机和网络设备常用的层次化分组交换网络协议集。TCP/IP隐藏了各种网络和硬件的特点及弱点，使各种类型的计算机和网络都能够进行可靠地传输。用网络术语来说，http协议位于TCP协议的上层。http协议使用TCP来传输其报文数据。与之类似，TCP则位于IP的上层。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter1/http1-2.png">
在HTTP客户端向服务器端发送报文之前，需要用网际协议(Internet Protocol, IP)地址和端口号在客户端和服务器之间建立一条TCP/IP链接。一个基本的浏览器链接显示的过程如下图所示。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter1/http1-3.png"></p>
<h4 id="Web的结构组件"><a href="#Web的结构组件" class="headerlink" title="Web的结构组件"></a>Web的结构组件</h4><ul>
<li><p>代理</p>
<p>  位于客户端和服务器之间的HTTP中间实体。代理位于客户端和服务器之间，接收所有客户端的http请求，并将这些请求转发给服务器。</p>
</li>
<li><p>缓存</p>
<p>  HTTP的仓库，使常用页面的副本可以保存在离客户端更近的地方。web缓存(web cache)或代理缓存(proxy cache)是一种特殊的http代理服务器，可以将经过代理传送的常用文档复制保存下来。下一个请求同一文档的客户端就可以享受缓存的私有副本所提供的服务了。</p>
</li>
<li><p>网关</p>
<p>  连接其他应用程序的特殊Web服务器。网关(gateway)一种特殊的服务器，作为其他服务器的中间实体使用。通常用于将http流量转成其他的协议。网关接受请求时就像自己是资源的源端服务器一样。客户端可能并不知道自己正在与一个网关进行通信。</p>
</li>
<li><p>隧道</p>
<p>  对http通信报文进行盲转发的特殊代理。隧道(tunnel)是建立起来之后，就会在两条连接之间对原始数据进行盲转发的http应用程序。http隧道通常用来在一条或者多条http连接上转发非http数据，转发时不会窥探数据。
  http隧道的一种常见用途是通过http连接承载加密的安全套接字层(SSL,Secure Sockets Layer)流量，这样SSL流量就可以穿过只允许web流量通过的防火墙了。如下图所示，http/ssl隧道收到了一条http请求，要求建立一条到目的地址和端口的输出链接，然后在http信道上通过隧道传输加密的ssl流量，这样就可以将其盲转发到目的服务器上去了。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter1/http1-4.png"></p>
</li>
</ul>
<ul>
<li><p>Agent代理</p>
<p>  发起自动HTTP请求的半智能Web客户端。用户Agent代理是代表用户发起http请求的客户端程序。所有发布web请求的应用程序都是http agent代理。比如说常见的web 浏览器。</p>
</li>
</ul>
<h2 id="第二章-URL与资源"><a href="#第二章-URL与资源" class="headerlink" title="第二章 URL与资源"></a>第二章 URL与资源</h2><blockquote>URL是因特网资源的标准化名称。URL指向每一条电子信息，告诉你它们位于何处，以及如何与之进行交互。</blockquote>    

<h4 id="URL组成部分"><a href="#URL组成部分" class="headerlink" title="URL组成部分"></a>URL组成部分</h4><ul>
<li>URL的第一部分(http)是URL方案(scheme)。方案可以告知Web客户端怎样访问资源。在这个例子中，URL说明要使用HTTP协议。</li>
<li>URL的第二部分指的是服务器的位置。这部分告知web客户端资源位于何处。</li>
<li>URL的第三部分是资源路径。路径说明了请求的是服务器上哪个特定的本地资源。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-1.png">
URL可以通过http之外的其他协议来访问资源。它们可以指向因特网上的任意资源。<em>URL提供了一种统一的资源命名方式。大多数URL都有同样的：“方案://服务器位置/路径”结构。</em></li>
</ul>
<h4 id="URL的语法"><a href="#URL的语法" class="headerlink" title="URL的语法"></a>URL的语法</h4><p>大多数URL方案的URL语法都建立下面这个由9部分构成的通用格式上：</p>
<p><scheme>://<user>:<password>@<host>:<port>/<path></path>;<params>?<query>#<frag></frag></query></params></port></host></password></user></scheme></p>
<p>但是几乎没有哪个URL中包含了所有的这些组件。URL最重要的3个部分是方案、主机和路径。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-2.png"></p>
<h4>主机与端口</h4>

<p>要想在因特网上找到资源，应用程序要知道是哪一台机器装载了资源，以及在那台机器的什么地方可以找到能对目标资源进行访问的服务器。URL的主机和端口组件提供了这两组信息。主机组件标识了因特网上能够访问资源的宿主机器。可以用主机名(www.joes.com)或者IP地址来指向宿主机器。<br><br>端口组件标识了服务器正在监听的网络端口。对下层使用了TCP协议的http来说，默认端口号是80。</p>
<h4>片段 (frag)</h4>

<p>为了引用部分资源或资源的一个片段，URL支持使用片段组件来表示一个资源内部的片段。片段挂在URL的右手边，最前面有一个字符“#”。http服务器通常只处理整个对象，而不是对象的片段，客户端不能将片段传送给服务器。浏览器从服务器获得了整个资源之后，会根据片段来显示你感兴趣的那部分资源。</p>
<h4>URL字符集</h4>
ASCII历史悠久，具有很好的可移植性。它使用7位二进制码来表示英文打字机提供的大多数按键以及少数用于文本格式和硬件通知的不可打印控制字符。但是，它并不支持世界其他数百种非罗马语言中很常见的变体字符。而且，有些URL重还会包含任意的二进制数据。认识到对完整性的需求之后，URL的设计者就将转义序列集成进去。通过转义序列，就可以用ASCII字符集的有限子集对任意字符值或者数据进行编码了。

为了避开安全字符集表示法带来的限制，人们设计了一种编码机制，用来在URL中表示各种不安全的字符。这种编码机制就是通过一种“转义”表示法来表示不安全字符的。这种转义表示法包含一个百分号(%)，后面跟着两个表示字符ASCII码的十六进制数。

    字符~ 对应ASCII码0x7E 在url中表示为%7E.
    空格 对应ASCII吗 0x20 在url中表示为%20.
在url中，有几个字符被保留起来，有着特殊的含义。下表列出了一些字符，在将其用于保留用途之外的场合时，要在url中对其进行编码。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-3.png">

下面为节选的一些方案介绍。

<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-4.png">

<h2>第三章 HTTP报文</h2>

<blockquote></blockquote>如果说HTTP是因特网的信使，那么HTTP报文就是它用来搬东西的包裹了。

<h4>报文流</h4>

<p>HTTP报文是在HTTP应用程序之间发送的数据块。这些数据块以一些文本形式的元信息开头，这些信息描述了报文的内容及含义，后面跟着可选的数据部分。</p>
<p>HTTP使用术语流入和流出来描述事务处理的方向。报文流入源端服务器，工作完成之后，会流回用户的Agent代理中。</p>
<p>HTTP报文会像水流一样流动。不管是请求报文还是响应报文，所有报文都会向下游流动。所有报文的发送者都在接受者的上游。</p>
<h4>报文的组成部分</h4>

<p>每条报文都包含一条来自客户端的请求，或者是一条来自服务器的响应。它们由三个部分组成：对报文进行描述的起始行、包含属性的首部块，以及可选的、包含数据的主体部分。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-5.png"></p>
<p>起始行和首部就是由行分隔的ASCII文本。每行都以一个由两个字符组成的行终止序列作为结束，其中包括一个回车符和一个换行符。这个行终止序列可以写做CRLF。</p>
<ul>
    <li>请求报文的格式 <br>
        （method） （request-URL） （version）
        <br>
        （headers）
        <br>
        <br>
        （entity-body）
    </li>
    <li>响应报文的格式 <br>
        （version） （status） （reason-phrase）
        <br>
        （headers）
        <br>
        <br>
        （entity-body）
    </li>
</ul>

<p></p><h4>起始行</h4><p></p>
<blockquote>所有的HTTP报文都以一个起始行作为开始。请求报文的起始行说明了要做些什么。响应报文的起始行说明发生了什么。</blockquote>

<p><em>请求行：</em>请求报文请求服务器对资源进行一些操作。其包含一个方法，一个请求URL以及HTTP版本。所有这些字段都由空格符分隔。
<br>
<br></p>
<p><em>响应行：</em>响应报文承载了状态信息和操作产生的所有结果数据。其包含了使用的HTTP版本，数字状态码以及与数字状态码对应的原因短语。所有这些字段都由空格符分隔。
<br>
<br></p>
<p><em>方法：</em>
<br>
<br></p>
<p><img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-6.png">
<em>状态码：</em>
<br>
<br></p>
<p><img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-7.png"></p>
<p></p><h4>首部</h4><p></p>
<p><blockquote>HTTP首部字段向请求和响应报文中添加了一些附加信息。本质上说，它们只是一些名/值对的列表</blockquote>
下面是一些的节选的首部实例。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-8.png"></p>
<p></p><h4>实体的主体部分</h4><p></p>
<p><blockquote>HTTP报文的第三部分是可选的实体主体部分。实体的主体是HTTP报文的负荷。就是HTTP要传输的内容</blockquote>
HTTP报文可以承载很多类型的数字数据：图片、视频、HTML文档、软件应用程序等等。</p>
<p></p><h4>方法</h4><p></p>
<p><blockquote>并不是每一个服务器都实现了所有的方法。如果一台服务器要与HTTP1.1兼容，那么只要为其资源实现GET方法和HEAD方法就可以了</blockquote></p>
<ul>
    <li>安全方法
        <br>
        HTTP定义了一组被称为安全方法的方法。GET方法和HEAD方法都被认为是安全的，这就意味着使用GET或HEAD方法的HTTP请求都不会产生什么动作。不产生动作，在这里意味着该请求不会在服务器上产生什么结果。
    </li>
    <li>GET
        <br>
        GET方法通常用于请求服务器发送某个资源。HTTP/1.1要求服务器实现此方法。
    </li>
    <li>HEAD
        <br>
        HEAD方法与GET方法的行为很类似，但服务器在响应中只返回首部。不会返回报文的实体主体部分。使用HEAD:<br>
        <ul>
            <li>在不获取资源的情况下了解资源的情况(比如，判断其类型)</li>
            <li>通过查看响应中的状态码，看看某个对象是否存在</li>
            <li>通过查看首部，测试资源是否被修改了</li>
        </ul>
    </li>
    <li>PUT
        <br>
        与GET从服务器读取文档相反，PUT方法会向服务器写入文档。有些发布系统允许用户创建Web页面，并用PUT直接将其安装到Web服务器上去。
        <img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-9.png">
        PUT方法的语义就是让服务器用请求的主体部分来创建一个由所请求的URL命名的新文档，或者， 如果那个URL已经存在的话，就用这个主体来替代它。<br>    </li>
    <li>POST
        <br>
        POST方法起初是用来向服务器输入数据。实际上，通过会用它来支持HTML表单。表单中填好的数据通常会被发送给服务器。
    </li>
    <li>TRACE
        <br>
        客户端发起一个请求时，这个请求可能要穿过防火墙、代理、网关等其他一些应用程序。每个中间节点都可能会修改原始的HTTP请求。TRACE方法允许客户端在最终将请求发送给服务器的时候，看看它变成了什么样子。
        <br>
        TRACE请求会在目的服务器端发起一个”环回”诊断。行程最后一站的服务器会弹回一条TRACE响应，并在响应主体中携带它收到的原始请求报文。TRACE请求中不能带有实体的主体部分。TRACE响应的实体主体部分包含了响应服务器收到的请求的精确副本。
        <img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-10.png"><br>    </li>
    <li>OPTIONS
        <br><br>        OPTIONS方法请求web服务器告知其支持的各种功能。可以询问服务器通常支持哪些方法，或者对某些特定资源支持哪些方法。
    </li>
    <li>DELETE
        <br><br>        顾名思义，DELETE方法所做的事情就是请求服务器删除请求URL所指定的资源。
    </li>
</ul>

<p></p><h4>状态码</h4><p></p>
<ul>
    <li>100-199(信息性状态码)
        <br>
    </li>
    <li>200-299(成功状态码)
        <img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-11.png"><br>    </li>
    <li>300-399(重定向状态码)
        <img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-12.png"> 
        <img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter2/http2-13.png"> 
    </li>
    <li>400-499(客户端错误状态码)</li>
    <li>500-599(服务器错误状态码)</li>
</ul>
<h4>首部</h4>
<ul>
    <li>通用首部
        <br>
        Date，提供日期和时间标志。<br>
        Connection，允许客户端和服务器指定与请求/响应连接有关的选项。。。。
        <br>
        通用缓存首部。http/1.0引入了第一个允许http应用程序缓存对象本地副本的首部。
         <br>
         Cache-control。
    </li>
    <li>请求首部
        <br>
        <ul>
            <li>信息性首部<br>
                Host.给出了接收请求的服务器的主机名和端口号<br>
                Referer.提供了包含当前请求的URI的文档的URL <br>
                User-Agent.将发起请求的应用程序名称告知服务器。….
            </li>
            <li>Accept首部
                <br>
                Accept.告诉服务器能够发送哪些媒体类型<br>
                Accept-Charset.告诉服务器能够发送哪些字符集<br>
                Accept-Encoding.告诉服务器能够发送哪些编码方式<br>
                ……
            </li>
            <li>条件请求首部
                <br>
                通过条件请求首部，客户端就可以为请求加上这种限制，要求服务器在对请求进行响应之前，确保某个条件为真。<br>
                Expect.允许客户端列出某请求所要求的服务器行为。<br>
                If-Match.如果实体标记与文档当前的实体标记相匹配，就获取这份文档。<br>
                If-None-Match.如果实体标记与文档当前的实体标记不相符，就获取这份文档。<br>
                If-Modified-Since.除非在某个指定日期之后资源被修改过，否则就限制这个请求<br>
                If-Range.允许对文档的某个范围进行条件请求。
            </li>
            <li>安全请求首部<br>
                http本身就支持一种简单的机制，可以对请求进行质询/响应认证。<br>
                Authorization.包含了客户端提供给服务器，以便对其自身进行认证的数据。<br>
                Cookie.客户端发送到服务器的数据字段<br>
                Cookie2.用来说明请求端支持的cookie版本。
            </li>
            <li>代理请求首部
                <br>
                Max-Forward.在通往源端服务器的路径上，将请求转发给其他代理服务器或网关的最大次数。<br>
                Proxy-Authorization.与Authorization首部相同，但这个是在与代理进行认证时使用的。<br>
                ……
            </li>
        </ul>
    </li>
    <li>响应首部
        <br>
        <ul>
            <li>信息性首部
                <br>
                Age.（从最初创建开始）响应持续时间。<br>
                Public.服务器为其资源支持的请求方法列表。<br>
                Server.服务器应用软件的名称和版本<br>
                …..
            </li>
            <li>协商首部<br>
                Accept-Ranges.对此资源来说，服务器可接受的范围类型。。。。

            </li>
            <li>安全响应首部
                <br>
                Proxy-Authenticate.来自代理的对客户端的质询列表。<br>
                Set-Cookie. <br>
                …..
            </li>
        </ul>
    </li>
    <li>实体首部
        有很多首部可以用来描述http报文的负荷。实体首部提供了有关实体及其内容的大量信息。
        <ul>
            <li>实体的信息性首部
                <br>
                Allow.列出了可以对此实体执行的请求方法。<br>
                Location.告知客户端实体实际上位于何处，用于将接收端定向到资源的位置上去。
            </li>
            <li>实体的内容首部
                <br>
                Content-Base.解析主体中的相对URL时使用的基础URL <br>
                Content-length.主体的长度或尺寸<br>
                Content-type.这个主体的对象类型。<br>
                Content-Language.。。。。。。。
            </li>
            <li>实体的缓存首部
                <br>
                ETag. 与此实体相关的实体标记<br>
                Expires. 实体不再有效，要从原始的源端再次获取此实体的日期和时间<br>
                Last-Modified. 这个实体最后一次被修改的日期和时间。
            </li>
        </ul>
    </li>
</ul>

<p></p><h2>第四章、连接管理</h2><p></p>
<p></p><h4>TCP连接</h4>
TCP为HTTP提供了一条可靠的比特传输管道。从TCP连接一端填入的字节会从另一端以原有的顺序、正确地传送出来。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter4/chapter4-1.png">  <p></p>
<p></p><h4>TCP流是分段的、由IP分组传输</h4>
TCP的数据是通过名为IP分组（或IP数据报）的小数据块来发送的。这样的话，如下图所示，http就是“http over tcp over ip”这个“协议栈”中的最顶层了。其安全版本https就是在http于tcp之间插入了一个（称为TLS或SSL）密码加密层。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter4/chapter4-2.png"><br>http要传输一条报文时，会以流的形式将报文数据的内容通过一条打开的TCP连接按序传输。TCP收到数据流之后，会将数据流砍成被称作段的小数据块，并将段封装在IP分组中，通过因特网进行传输。所有这些工作都是由TCP/IP软件来处理的，http程序员什么都看不到。<br><p></p>
<p>…先跳过这一章。</p>
<p></p><h2>第五章、Web服务器</h2>
基本的web服务器一般执行了下述几项任务。<br><p></p>
<ul>
    <li>1.建立连接-接受一个客户端连接。</li>
    <li>2.接收请求-从网络中读取一条http请求报文。</li>
    <li>3.处理请求-对请求报文进行解释，并采取行动。</li>
    <li>4.访问资源-访问报文中指定的资源。</li>
    <li>5.构建响应-创建带有正确首部的http响应报文。</li>
    <li>6.发送响应-将响应回送给客户端。</li>
    <li>7.记录事务处理过程-将与己完成事务有关的内容记录在一个日志文件中。</li>
</ul>
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter4/chapter4-3.png"> 
<h4>重定向</h4> 
重定向可适用于下列情况：
<ul>
    <li>永久删除的资源（301）</li>
    <li>临时删除的资源（303）</li>
    <li>URL增强。</li>
    <li>负载均衡
        <br>
        如果一个超载的服务器收到一个请求，服务器可以将客户端重新定向到一个负载不太重的服务器上去。
    </li>
    <li>服务器关联</li>
    <li>规范目录名称</li>
</ul>

<p></p><h2>第六章、代理</h2><p></p>
<p><blockquote>http的代理服务器即是Web服务器又是Web客户端。http客户端会向代理发送请求报文。代理服务器必须像web服务器一样，正确地处理请求和连接，然后返回响应。同时，代理自身要向服务器发送请求，这样，其行为就必须像正确地http客户端一样，要发送请求并接收响应。</blockquote></p>
<p></p><h4>私有和共享代理</h4>
单个客户端专用的代理被称为私有代理。众多客户端共享的代理被称为公共代理。
<img src="http://outqqzk4u.bkt.clouddn.com/img/study/github_blog/http/chapter4/chapter4-4.png"> <p></p>
<p></p><h4>代理与网关的对比</h4>
严格来说，代理连接的是两个或者多个使用相同协议的应用程序。而网关连接的则是两个或多个使用不同协议的端点。网关扮演的是“协议转换器”的角色，即使客户端和服务端使用的是不同的协议，客户端也可以通过它完成与服务器之间的事务处理。实际上，代理和网关之间的区别很模糊。由于浏览器和服务器实现的是不同版本的http,代理也经常要做一些协议转换工作。而商业化的代理服务器也会实现网关的功能来支持SSL安全协议、SOCKS防火墙、FTP访问，以及基于web的应用程序。<p></p>
<p></p><h4>为什么使用代理</h4><p></p>
<ul>
    <li>儿童过滤器。
        <br>
        可以利用过滤器代理来阻止学生访问成人内容。
    </li>
    <li>文档访问控制。
        <br>
        可以用代理服务器在大量web服务器和web资源之间实现统一的访问控制策略。
    </li>
    <li>安全防火墙。
    </li>
    <li>web缓存。
        <br>
        代理缓存维护了常用文档的本地副本。
    </li>
    <li>反向代理。
        <br>
        代理可以假扮web服务器。这些被称为反向代理的代理接受发给web服务器的真实请求，但与web服务器不同的是，它们可以发起与其他服务器的通信，以便按需定位所请求的内容。可以用这些反向代理来提高访问慢速web服务器上公共内容时的性能。在这种配置中，通常将这些反向代理称为服务器加速器。
    </li>
</ul>
。。。。。。。。
<h4>代理的层次结构</h4>
可以通过代理层次结构将代理级联起来。代理的层次结构可以是静态的，也可以是动态的。静态的代理层次结构中，子代理总会将报文转发给父代理，再有父代理将报文转发给服务器。而动态的代理层次结构中。访问代理会根据不同的情况将报文转发给不同的父代理或者原始服务器。<br>
这里有几个动态选择父代理的例子：
<ul>
    <li>负载均衡
        <br>
        子代理可能会根据当前父代理上的工作负载级别来决定如何选择一个父代理。以均衡负载。
    </li>
    <li>地理位置附近的路由
        <br>
        子代理可能会选择负责原始服务器所在物理区域的父代理。
    </li>
    <li>协议/类型路由
        <br>
        子代理可能会根据URI将报文转发到不同的父代理和原始服务器上。某些特定类型的URI可能要通过一些特殊的代理服务器转发请求。以便进行特殊的协议处理。
    </li>
</ul>
<h4>代理是如何获取流量的</h4>
<ul>
    <li>修改客户端
        <br>
        很多web客户端，都支持手工和自动的代理配置。如果将客户端配置为使用代理服务器，客户端就会将http请求有意地直接发送给代理，而不是原始服务器。

    </li>
    <li>修改网络
        <br>
        网络基础设施可以通过若干种技术手段，在客户端不知道，或没有参与的情况下，拦截网络流量并将其导入代理。这种拦截通常都依赖于监视http流量的交换设备及路由设备，在客户端毫不知情的情况下，对其进行拦截，将其流量导入一个代理。这种代理被称为拦截代理。
    </li>
    <li>修改DNS的命名空间
        <br>
        放在web服务器之间的代理服务器–替代物。会直接假扮web服务器的名字和ip地址。
    </li>
    <li>修改web服务器
        <br>
        也可以将某些web服务器配置为向客户端发送一条http重定向命令。将客户端请求重定向到一个代理上去。
    </li>
</ul>

<p></p><h4>代理URI与服务器URI的不同</h4>
客户端向web服务器发送请求时，请求行中只包含部分URI(没有方案、主机或端口)。方案可以告知Web客户端怎样访问资源。在这个例子中，URL说明要使用HTTP协议。<br>
但是当客户端向代理发送请求时，请求行中则包含完整的URI。<p></p>


                <hr>

                

                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2017/06/08/javascript-book2/" data-toggle="tooltip" data-placement="top" title="JavaScript权威指南">&larr; Previous Post</a>
                        </li>
                    
                    
                </ul>

                

                

            </div>
    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-3
                col-md-3
                col-md-offset-0
                col-md-offset-0
                hidden-xs	
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">目录</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->

            <div class="
                col-lg-8 
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#O&#39;REILLY" title="O&#39;REILLY">O&#39;REILLY</a>
                        
                          <a class="tag" href="/tags/#http" title="http">http</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                </ul>
                
            </div>

        </div>
    </div>
</article>







<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    // async("https://cdn.bootcss.com/anchor-js/4.1.0/anchor.min.js",function(){
    //     anchors.options = {
    //       visible: 'always',
    //       placement: 'left',
    //       icon: ''
    //     };
    //     // anchors.add();
    //     // anchors.add('.post-container h1, .post-container h2, .post-container h3, .post-container h4');
    //     simpleNav();
    // })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>




    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Mingru’s Blog 2018 
                    <br>
                    <!--Theme by <a href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    Ported by <a href="http://blog.kaijun.rocks">Kaijun</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=kaijun&repo=hexo-theme-huxblog&type=star&count=true" >
                    </iframe>-->
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.js"></script>
<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://mingrutough.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->


<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        console.log(a);
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;    
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        // $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: true,
            easing: "swing",
            filter: "",
            scrollSpeed: 500,
            scrollOffset: 0,
            scrollThreshold: .5,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });    

    function catalogPosition(){
        
    };
    var catTopDis = $('.catalog-container').offset().top; // 导航距离顶部距离(position不为fixed时) 
    var catLeftDis = $('.catalog-container').offset().left; // 导航距离顶部距离(position不为fixed时)  
    navFixed();
    $(document).on('scroll',navFixed);
    function navFixed(){ // 根据当前页面滚动情况固定导航栏
        var scrollHeight = $(document).scrollTop();         
        if(scrollHeight > catTopDis){
            if(!$('.catalog-container').hasClass('catalog-fixed')) {
                $('.catalog-container').addClass('catalog-fixed').css('left',catLeftDis); ;
            } 
                
        } else{
            if($('.catalog-container').hasClass('catalog-fixed')) {                       
                $('.catalog-container').removeClass('catalog-fixed').css('left',0); ;

            } 
        }
    }
    // $(window).on('resize',function(){
    //     catTopDis = $('.catalog-container').offset().top; // 导航距离顶部距离(position不为fixed时) 
    //     catLeftDis = $('.catalog-container').offset().left; // 导航距离顶部距离(position不为fixed时)  
    // });
</script>




<!-- Image to hack wechat -->
<!--<img src="https://mingrutough.github.io/img/icon_wechat.png" width="0" height="0" />-->
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
